---
title: "TEST TEST"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
library(latexpdf)
library(stringr)
library(ggplot2)
```
# Abstract
This is where the abstract will take place

# Introduction
This is where the introduction will take place

# Data Description

<br />

> About the Data - Red Wine Quality

First, we will read the red wine data and look at the fundamentals of the data. We will also generate a pairs plot and see the approximate relationship between the variables.

```{r, eval=TRUE}
red.wine = read.csv("winequality-red.csv", header=TRUE, sep=";")
names(red.wine)
dim(red.wine)
sapply(red.wine, class)
red.info = summary(red.wine)
```
<br />
Include some basic descriptions including the class and the descriptive statistics of the variables. 

<br />
```{r, fig.width = 7, fig.height = 7}
pairs(red.wine)
```

Include some basic description regarding the pairs plot.

<br />


<br />
Include some basic descriptions including the class and the descriptive statistics of the variables. 


> New Additional Data Point

Before we begin the data analysis, we will introduce the median point as a new additional data point to both the red and white wine data.

```{r}
red.datapoints = vector(mode = 'numeric', length = 12)

for (i in 1:12) {
red.med = as.numeric(str_extract(red.info[3,i], "\\d+\\.*\\d*")) #extracts value from summary
red.datapoints[i] = red.med
}

red.wine = rbind(red.wine, red.datapoints)
```

We now introduced the median point as a new point to the red wine quality data.

<br />


> Data Visualization - Histograms

Now for the last step before going into fitting the model into a linear model, we will generate several histograms for the all the variables. This will help us see the approximate relationship between each varibles and wine quality.

```{r}
ggplot(aes(quality), data = red.wine) +
  geom_histogram(aes(color=I('black'), fill=I('firebrick')), binwidth = 1) +
  ggtitle('Histogram of Quality')
```
<br />

Comments on the histogram.

```{r}
ggplot(aes(fixed.acidity), data = red.wine) +
  geom_histogram(aes(color=I('black'), fill=I('firebrick')), binwidth = 0.2) +
  ggtitle('Histogram of Fixed Acidity')

```
<br />

Comments on the histogram.

```{r}
ggplot(aes(volatile.acidity), data = red.wine) +
  geom_histogram(aes(color=I('black'), fill=I('firebrick')), binwidth = 0.02) +
  ggtitle('Histogram of Volatile Acidity')
```
<br />

Comments on the histogram.

```{r}
ggplot(aes(citric.acid), data = red.wine) +
  geom_histogram(aes(color=I('black'), fill=I('firebrick')), binwidth = 0.05) +
  ggtitle('Histogram of Citric Acid')
```
<br />

Comments on the histogram.

```{r}
ggplot(aes(residual.sugar), data = red.wine) +
  geom_histogram(aes(color=I('black'), fill=I('firebrick')), binwidth = 0.5) +
  ggtitle('Histogram of Residual Sugar')
```
<br />

Comments on the histogram.

```{r}
ggplot(aes(chlorides), data = red.wine) +
  geom_histogram(aes(color=I('black'), fill=I('firebrick')), binwidth = 0.05) +
  ggtitle('Histogram of Chlorides')
```
<br />

Comments on the histogram.

```{r}
ggplot(aes(free.sulfur.dioxide), data = red.wine) +
  geom_histogram(aes(color=I('black'), fill=I('firebrick')), binwidth = 3) +
  ggtitle('Histogram of Free Sulfur Dioxide')
```
<br />

Comments on the histogram.

```{r}
ggplot(aes(total.sulfur.dioxide), data = red.wine) +
  geom_histogram(aes(color=I('black'), fill=I('firebrick')), binwidth = 8) +
  ggtitle('Histogram of Total Sulfur Dioxide')
```
<br />

Comments on the histogram.

```{r}
ggplot(aes(density), data = red.wine) +
  geom_histogram(aes(color=I('black'), fill=I('firebrick')), binwidth = 0.0005) +
  ggtitle('Histogram of Density')
```
<br />

Comments on the histogram.

```{r}
ggplot(aes(pH), data = red.wine) +
  geom_histogram(aes(color=I('black'), fill=I('firebrick')), binwidth = 0.02) +
  ggtitle('Histogram of pH')
```
<br />

Comments on the histogram.

```{r}
ggplot(aes(sulphates), data = red.wine) +
  geom_histogram(aes(color=I('black'), fill=I('firebrick')), binwidth = 0.1) +
  ggtitle('Histogram of Sulphates')
```
<br />

Comments on the histogram.

```{r}
ggplot(aes(alcohol), data = red.wine) +
  geom_histogram(aes(color=I('black'), fill=I('firebrick')), binwidth = 0.3) +
  ggtitle('Histogram of Alcohol')
```
<br />

Comments on the histogram.

<br />

# Methods

<br />

## Multiple Linear Regression
<br />

> Pairs Plot

First, with red wine, conduct a pairs plot to see if there are any particular patterns.

```{r}
pairs(red.wine)
```

The pairs plot tells us a bit about the relationship between variables in the dataset. Specifically, we can see that a linear model seems appropriate, although some of the variables seem to have less of a linear relationship (we can look into that by conducting hypothesis tests). Also, we have to keep in mind of the multicollinearity present among the explanatory variables. Now, we will conduct a linear regression against the quality of the red wine.
<br />

> Fitting Into a Linear Model

```{r}
red.mdl = lm(quality~., data=red.wine)
summary(red.mdl)
```

There are a couple of things that we notice from the summary of the linear model. 

* The P-value of the overall regression is significantly small, which suggests that there is a linear association between at least one of the regressors and the wine quality.
* The adjusted R-squared value is 0.3561 (35.61%), which implies that our linear model is not doing a good job at predicting the values. 
* Looking at the individual P-values, fixed acidity, citric acid, residual sugar and density seem to be insignificant given that all the other variables are in the model. 

In order to see if some of the regressors are insignificant to the regression, we will first run the anova test.

> Anova Test

```{r}
anova(red.mdl)
```

The anova test conducts a partial F-test, and supports our hypothesis that citric acid and residual sugar variable seem to be insiginificant to the linear model given that the variables before them are already included in the model.

To check which of the variables must be selected in building the model, we will conduct the variable selection.

> Variable Selection

```{r}
step(red.mdl, direction = "both")
```
Based on the stepwise variable selection based on the AIC values, only 7 regressors are included in the model, which include volatile acidity, chlorides, free sulfur dioxide, total sulfur dioxide, pH, sulphates, and alcohol. 

Hence, the final model would be 
quality = $\beta_0$ + $\beta_1$ * volatile acidity + $\beta_2$ * chlorides + $\beta_3$ * free sulfur dioxide + $\beta_4$ * total sulfur dioxide + $\beta_5$ * pH + $\beta_6$ * sulphates + $\beta_7$ * alcohol. 

> Regressing The Final Model

```{r}
red.fin = lm(quality ~ volatile.acidity + chlorides + free.sulfur.dioxide + total.sulfur.dioxide + pH + sulphates + alcohol, data=red.wine)
summary(red.fin)
```

We can recognize the following from the summary of the final model. 

* The P-value of the overall regression is significantly small, which suggests that there is a linear association between at least one of the regressors and the wine quality.
* The adjusted R-squared value is 0.3566 (35.66%), which is not much of an increase from the originial model. This implies that we might need to transform the data and deal with the influential points.

<br />

## Model Assessment
<br />

> Hidden Extrapolation

```{r}
X = cbind(c(1, nrow(red.wine)), red.wine$fixed.acidity, red.wine$volatile.acidity, red.wine$citric.acid, red.wine$residual.sugar, red.wine$chlorides, red.wine$free.sulfur.dioxide, red.wine$total.sulfur.dioxide, red.wine$density, red.wine$pH, red.wine$sulphates, red.wine$alcohol, red.wine$quality)
```
